var Promise = require('lie');
var readtools = require('lib/readtools');
var readconf = require('lib/readconf');
var file_exists = require('is-there');
var c = require('chalk');
// ----------------------------------------------------------------------------

module.exports = function (cwd, args, draftdir) {
	var conf = readconf(cwd, '.valkyrja');
	var tools = readtools(cwd, '.valkyrja');

	// placeholder function
	// currently there is nothing in need of cleaning
	process.stdout.write(c.gray('purging') + ' ' + cwd);
	console.log(' ' + c.gray('[') + c.blue('done') + c.gray(']'));

	// run tools cleanup
	console.log(c.gray('running tools.clean'));

	var cleanstep = tools.clean(cwd, args, conf);

	if (cleanstep === true) {
		cleanstep = Promise.resolve();
	}

	cleanstep
		.then(function () {
			console.log(c.blue('cleanup complete'))
		}, function () {
			console.log(c.red('cleanup failed!'));
			return Promise.reject();
		});
};
