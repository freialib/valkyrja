var Promise = require('lie');
var readtools = require('lib/readtools');
var readconf = require('lib/readconf');
var file_exists = require('is-there');
var c = require('chalk');
// ----------------------------------------------------------------------------

module.exports = function (cwd, args, draftdir) {
	var conf = readconf(cwd, '.valkyrja');
	var tools = readtools(cwd, '.valkyrja');
	var p = tools.send(cwd, args, conf);

	if (p === true) {
		p = Promise.resolve();
	}

	if (p === false) {
		console.log('')
		console.log('Missing handling');
		p = Promise.reject();
	}

	return p.then(function () {
		console.log('');
		console.log(c.gray('[') + ' ' + c.blue('send succesful') + ' ' + c.gray(']'));
		console.log('');
	}, function (reason) {
		console.log('');
		console.log(c.gray('[') + ' ' + c.red.dim('send failed') + ' ' + c.gray(']'));
		console.log('');
		console.log(reason.stack || reason)
		console.log('');
	});
};
